# Notes – simonw/tools Exploration

## 2026-02-24

### What I'm investigating
The user wants to understand how https://github.com/simonw/tools works and wants a bare-bones version set up in this experiments folder.

### Research findings

#### Repository structure
- Root directory is a flat collection of self-contained HTML+JS tools (e.g. `xml-validator.html`, `yaml-explorer.html`)
- Each tool is a single file with no external build dependencies – just vanilla HTML/CSS/JS
- Some tools have a paired `.docs.md` file (e.g. `xml-validator.docs.md`) that is auto-generated by an LLM
- A `README.md` at the root serves as the source-of-truth index; it is converted to `index.html` by the build scripts
- Supporting Python scripts live at the root: `gather_links.py`, `build_index.py`, `build_colophon.py`, `build_dates.py`, `build_by_month.py`, `write_docs.py`, `build_redirects.py`
- `build.sh` orchestrates all scripts
- `_config.yml` configures Jekyll (used for final GitHub Pages deployment)
- `CNAME` file sets the custom domain
- `homepage-search.js` adds a client-side search widget to the index page

#### GitHub Actions (5 workflows)
1. **`pages.yml`** – core CI/CD
   - Triggers on push to `main` or manual dispatch
   - Checks out full git history (`fetch-depth: 0`)
   - Installs Python + `markdown`, `llm`, `llm-anthropic`
   - Runs `build.sh` which: gathers metadata, optionally runs LLM docs generation, builds HTML pages
   - Commits back generated `.docs.md` files if any changed
   - Deploys to GitHub Pages via Jekyll
   
2. **`claude.yml`** – Claude Code action
   - Responds to `@claude` mentions in issues, PRs, and review comments
   - Requires `CLAUDE_CODE_OAUTH_TOKEN` secret
   
3. **`claude-code-review.yml`** – Automatic PR reviews
   - Runs Claude Code Review on every PR open/synchronize
   - Requires `CLAUDE_CODE_OAUTH_TOKEN` secret
   
4. **`deploy-cloudflare-workers.yml`** – Cloudflare Worker deployment
   - Only fires when `cloudflare-workers/**` paths change
   - Used for OAuth proxy (GitHub auth) functionality in certain tools
   - Requires `CLOUDFLARE_API_TOKEN` and `CLOUDFLARE_ACCOUNT_ID` secrets
   
5. **`test.yml`** – Python tests
   - Runs `pytest` on push/PR
   - Tests the Python build scripts, not the HTML tools themselves

#### How the index page works
1. `README.md` contains the canonical list of tools, organized by category with plain markdown links
2. `gather_links.py` reads every `.html` file, extracts git commit history to determine creation/update dates, extracts titles from `<title>` tags, reads `.docs.md` descriptions, and writes `tools.json` (array of tool metadata)
3. `build_index.py` converts `README.md` to HTML using the `markdown` library, then injects a "Recently added / Recently updated" section between `<!-- recently starts -->` and `<!-- recently stops -->` comment markers
4. `homepage-search.js` is injected into the index page; it loads `tools.json` at runtime and provides a live search box

#### Summary/docs generation
- `write_docs.py` is called when `GENERATE_LLM_DOCS=1` (only in CI)
- It uses the `llm` CLI tool with the `llm-anthropic` plugin to call Claude Haiku
- For each `.html` file, it checks whether the `.docs.md` is current by comparing the stored commit hash; only regenerates when the file has changed
- Generated docs are 2-3 sentence markdown paragraphs stored as `.docs.md` files
- These docs are committed back to the repo as part of the CI workflow

#### Other infrastructure
- **Cloudflare Workers** – optional OAuth proxy for tools needing GitHub API write access (avoids exposing secrets client-side)
- **Custom domain** via `CNAME` file (tools.simonwillison.net)
- **Jekyll** – used only as a rendering layer for GitHub Pages; the Python scripts generate most HTML directly and Jekyll mostly handles routing/serving
- **`footer.js`** – injected into every tool page; provides a footer with links back to the index and colophon, records analytics to localStorage, adapts its colour scheme to the page background

### What's needed for a bare-bones version
- A handful of self-contained HTML tool files
- `README.md` as the index source (with category sections and `<!-- recently starts -->` markers)
- `gather_links.py` to produce `tools.json`
- `build_index.py` to generate `index.html` from README + tools.json
- `build.sh` to orchestrate
- `_config.yml` for Jekyll
- `.github/workflows/pages.yml` to build and deploy on push

Optional (not included in bare-bones):
- LLM docs generation (`write_docs.py`) – requires `ANTHROPIC_API_KEY`
- Claude Code action – requires `CLAUDE_CODE_OAUTH_TOKEN`
- Cloudflare Workers – requires separate account/secrets
- Custom domain (CNAME)

### Files created
- `bare-bones-site/` – minimal working version of the tools site
  - `README.md` – index source
  - `sample-tool.html` – an example self-contained tool
  - `gather_links.py` – adapted from simonw's version
  - `build_index.py` – adapted from simonw's version  
  - `build.sh` – orchestration script
  - `_config.yml` – Jekyll config
  - `.github/workflows/pages.yml` – GitHub Pages deployment workflow
